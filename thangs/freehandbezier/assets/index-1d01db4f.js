(function(){const t=document.createElement("link").relList;if(t&&t.supports&&t.supports("modulepreload"))return;for(const o of document.querySelectorAll('link[rel="modulepreload"]'))p(o);new MutationObserver(o=>{for(const r of o)if(r.type==="childList")for(const u of r.addedNodes)u.tagName==="LINK"&&u.rel==="modulepreload"&&p(u)}).observe(document,{childList:!0,subtree:!0});function n(o){const r={};return o.integrity&&(r.integrity=o.integrity),o.referrerPolicy&&(r.referrerPolicy=o.referrerPolicy),o.crossOrigin==="use-credentials"?r.credentials="include":o.crossOrigin==="anonymous"?r.credentials="omit":r.credentials="same-origin",r}function p(o){if(o.ep)return;o.ep=!0;const r=n(o);fetch(o.href,r)}})();let a;async function L(){const t=await(await fetch("./outf.wasm")).arrayBuffer();a=(await WebAssembly.instantiate(t)).instance}L();const c=document.getElementById("mycanvas"),x=document.getElementById("mysvg"),s=c.getContext("2d");s.fillStyle="#55555520";s.fillRect(0,0,c.width,c.height);s.fillStyle="black";var l=!1,d=[],f=[];c.addEventListener("mousedown",function(e){l=!0,s.moveTo(e.x,e.y)});c.addEventListener("touchstart",function(e){e.preventDefault(),l=!0,s.moveTo(e.touches[0].clientX,e.touches[0].clientY)});c.addEventListener("mousemove",function(e){e.preventDefault(),l&&(s.lineTo(e.x,e.y),d.push(e.x),f.push(e.y),s.stroke())});c.addEventListener("touchmove",function(e){e.preventDefault(),l&&(s.lineTo(e.changedTouches[0].clientX,e.changedTouches[0].clientY),d.push(e.changedTouches[0].clientX),f.push(e.changedTouches[0].clientY),s.stroke())});c.addEventListener("mouseup",function(e){l=!1,s.stroke(),s.moveTo(e.x,e.y);let[t,n]=b(d,f);w(t,n),a.exports.freeall(),d=[],f=[]});c.addEventListener("touchend",function(e){e.preventDefault(),l=!1,s.stroke(),s.moveTo(e.changedTouches[0].clientX,e.changedTouches[0].clientY);let[t,n]=b(d,f);w(t,n),a.exports.freeall(),d=[],f=[]});c.addEventListener("mouseleave",function(e){l=!1});c.addEventListener("touchcancel",function(e){e.preventDefault(),l=!1});function h(e){const t=a.exports.malloc(e*8),n=new Float64Array(a.exports.memory.buffer,t,e);return[t,n]}function b(e,t){let n=e.slice(1,e.length-1);const[p,o]=h(n.length);o.set(n);let r=t.slice(1,t.length-1);const[u,_]=h(r.length);_.set(r);const[v,m]=h(8);m.set([e[0],t[0],e[e.length-1],t[t.length-1]]);const[g,y]=h(8);let i=m;return y.set([i[0]*(1/3)+i[2]*(2/3),i[1]*(1/3)+i[3]*(2/3),i[0]*(2/3)+i[2]*(1/3),i[1]*(2/3)+i[3]*(1/3)]),a.exports.learn(.1,1e3,n.length,p,u,v,g),a.exports.learn(.01,1,n.length,p,u,v,g),[y,m]}function w(e,t){let n=document.createElementNS("http://www.w3.org/2000/svg","path");n.setAttribute("d",`M ${t[0]} ${t[1]} C ${e[0]} ${e[1]}, ${e[2]} ${e[3]} , ${t[2]} ${t[3]}`),n.setAttribute("stroke","red"),n.setAttribute("stroke-width",10),n.setAttribute("opacity",1),n.setAttribute("fill","none"),x.appendChild(n)}
