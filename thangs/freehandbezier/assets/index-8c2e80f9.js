(function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const n of document.querySelectorAll('link[rel="modulepreload"]'))u(n);new MutationObserver(n=>{for(const s of n)if(s.type==="childList")for(const l of s.addedNodes)l.tagName==="LINK"&&l.rel==="modulepreload"&&u(l)}).observe(document,{childList:!0,subtree:!0});function r(n){const s={};return n.integrity&&(s.integrity=n.integrity),n.referrerPolicy&&(s.referrerPolicy=n.referrerPolicy),n.crossOrigin==="use-credentials"?s.credentials="include":n.crossOrigin==="anonymous"?s.credentials="omit":s.credentials="same-origin",s}function u(n){if(n.ep)return;n.ep=!0;const s=r(n);fetch(n.href,s)}})();let d;async function A(){const e=await(await fetch("./outf.wasm")).arrayBuffer();d=(await WebAssembly.instantiate(e)).instance}A();const a=document.getElementById("mycanvas"),E=document.getElementById("mysvg"),i=a.getContext("2d");i.fillStyle="#55555520";i.fillRect(0,0,a.width,a.height);i.fillStyle="black";var f=!1,v=[],_=[];a.addEventListener("mousedown",function(t){f=!0,i.moveTo(t.x,t.y)});a.addEventListener("mousemove",function(t){f&&(i.lineTo(t.x,t.y),v.push(t.x),_.push(t.y),i.stroke())});a.addEventListener("mouseup",function(t){f=!1,i.stroke(),i.moveTo(t.x,t.y);let[e,r]=$(v,_);O(e,r),v=[],_=[]});a.addEventListener("mouseleave",function(t){f=!1});function c(t){const e=d.exports.malloc(t*8),r=new Float64Array(d.exports.memory.buffer,e,t);return[e,r]}function $(t,e){let r=t.slice(1,t.length-1);const[u,n]=c(r.length);n.set(r);let s=e.slice(1,e.length-1);const[l,b]=c(s.length);b.set(s);const[p,m]=c(4);m.set([t[0],e[0],t[t.length-1],e[e.length-1]]);const[h,g]=c(4);let o=m;g.set([o[0]*(1/3)+o[2]*(2/3),o[1]*(1/3)+o[3]*(2/3),o[1]*(1/3)+o[3]*(2/3),o[1]*(1/3)+o[3]*(2/3)]);const[N,w]=c(g.length);w.fill(0);const[y,x]=c(r.length);x.fill(0);const[P,L]=c(r.length);return L.fill(0),d.exports.learn(.1,2e3,r.length,u,l,p,h,y),d.exports.learn(.01,1e3,r.length,u,l,p,h,y),d.exports.learn(.001,1e3,r.length,u,l,p,h,y),[g,m]}function O(t,e){let r=document.createElementNS("http://www.w3.org/2000/svg","path");r.setAttribute("d",`M ${e[0]} ${e[1]} C ${t[0]} ${t[1]}, ${t[2]} ${t[3]} , ${e[2]} ${e[3]}`),r.setAttribute("stroke","red"),r.setAttribute("stroke-width",10),r.setAttribute("opacity",1),r.setAttribute("fill","none"),E.appendChild(r)}
